# Copyright (c) 2010 - 2013  Jonas Peters  [peters@stat.math.ethz.ch]
# All rights reserved.  See the file COPYING for license terms. 

# Modified by the authors of "Gradient-Based Neural DAG Learning"

library(mgcv)
library(MASS)
library(parallel)
library(pcalg)
library(kernlab)
library(igraph)
library(parallel)
library(gptk)
library(clue)
library(mboost)
library(fastICA)
library(glmnet)
library(CAM)

# parse command-line arguments
# order: Rscript experiments.R dataset_path exp_path nb_exp nb_core conda_env conda_path
args = commandArgs(trailingOnly=TRUE)
dataset_path <- args[1]   # path to the folder containing the dataset (DAG, CPDAG and data)
exp_path <- args[2]   # path to the folder where the results will be saved
nb_exp <- as.numeric(args[3])   # number of DAG to evaluate
nb_core <- as.numeric(args[4])   # number of CPU cores to use
conda_env <- args[5]
conda_path <- args[6]  # can use "auto".

library(reticulate)
source("../code/util/computeGaussKernel.R", chdir = TRUE)
source("../code/util_DAGs/computeCausOrder.R", chdir = TRUE)
source("./experiment2parralel.R", chdir = TRUE)
source("../code/startups/startupGES.R", chdir = TRUE)
source("../code/util_DAGs/randomB.R", chdir = TRUE)
source("../code/util_DAGs/randomDAG.R", chdir = TRUE)
source("../code/util_DAGs/dag2cpdagAdj.R", chdir = TRUE)
source("../code/util_DAGs/sampleDataFromG.R", chdir = TRUE)
source("../code/startups/startupSHD.R", chdir = TRUE)
source("../code/startups/startupSID.R", chdir = TRUE)
source("../code/startups/startupLINGAM.R", chdir = TRUE)
source("../code/startups/startupICML.R", chdir = TRUE)
source("../code/startups/startupBF.R", chdir = TRUE)
source("../code/startups/startupGDS.R", chdir = TRUE)
source("../code/startups/startupPC.R", chdir = TRUE)
source("../code/startups/startupScoreSEMIND.R", chdir = TRUE)

if (nb_core == -1){
  nb_core <- detectCores() - 1
  cat("Using ", nb_core, " cores")
}

use_condaenv(condaenv = conda_env, conda = conda_path)
np <- import("numpy")
pars <- list(regr.method = train_gp, regr.pars = list(), indtest.method = indtestHsic, indtest.pars = list())

# hyperparameters to use depending on setup
hparams <- list(pns_threshold=0.02, pruning_threshold=0.001, resit_alpha=0.05, ges_coeff=3.4538) # ges_coeff=0.5*log(nrow(data))

# open file only to figure out nVec and pVec.
data <- np$load(paste(dataset_path, "/data1.npy", sep=""))
nVec <- c(nrow(data)) # number of samples in training set
pVec <- c(ncol(data))  # number of variables in graph
funcType <-"GP" # "GAM" or "GP" (function used in GT model)

cam.time <- matrix(-1, length(nVec), length(pVec))
cam.time.sd <- matrix(-1, length(nVec), length(pVec))
lingam.time <- matrix(-1, length(nVec), length(pVec))
lingam.time.sd <- matrix(-1, length(nVec), length(pVec))
icml.time <- matrix(-1, length(nVec), length(pVec))
icml.time.sd <- matrix(-1, length(nVec), length(pVec))
gds.time <- matrix(-1, length(nVec), length(pVec))
gds.time.sd <- matrix(-1, length(nVec), length(pVec))
bf.time <- matrix(-1, length(nVec), length(pVec))
bf.time.sd <- matrix(-1, length(nVec), length(pVec))
cpc.time <- matrix(-1, length(nVec), length(pVec))
cpc.time.sd <- matrix(-1, length(nVec), length(pVec))
pc.time <- matrix(-1, length(nVec), length(pVec))
pc.time.sd <- matrix(-1, length(nVec), length(pVec))
ges.time <- matrix(-1, length(nVec), length(pVec))
ges.time.sd <- matrix(-1, length(nVec), length(pVec))
rand.time <- matrix(-1, length(nVec), length(pVec))
rand.time.sd <- matrix(-1, length(nVec), length(pVec))

cam.fdr <- matrix(-1, length(nVec), length(pVec))
cam.fdr.sd <- matrix(-1, length(nVec), length(pVec))
lingam.fdr <- matrix(-1, length(nVec), length(pVec))
lingam.fdr.sd <- matrix(-1, length(nVec), length(pVec))
icml.fdr <- matrix(-1, length(nVec), length(pVec))
icml.fdr.sd <- matrix(-1, length(nVec), length(pVec))
gds.fdr <- matrix(-1, length(nVec), length(pVec))
gds.fdr.sd <- matrix(-1, length(nVec), length(pVec))
bf.fdr <- matrix(-1, length(nVec), length(pVec))
bf.fdr.sd <- matrix(-1, length(nVec), length(pVec))
cpc.fdr <- matrix(-1, length(nVec), length(pVec))
cpc.fdr.sd <- matrix(-1, length(nVec), length(pVec))
pc.fdr <- matrix(-1, length(nVec), length(pVec))
pc.fdr.sd <- matrix(-1, length(nVec), length(pVec))
ges.fdr <- matrix(-1, length(nVec), length(pVec))
ges.fdr.sd <- matrix(-1, length(nVec), length(pVec))
rand.fdr <- matrix(-1, length(nVec), length(pVec))
rand.fdr.sd <- matrix(-1, length(nVec), length(pVec))

hdcamDAG <- matrix(-1, length(nVec), length(pVec))
hdcamDAGsd <- matrix(-1, length(nVec), length(pVec))
hdlingamDAG <- matrix(-1, length(nVec), length(pVec))
hdlingamDAGsd <- matrix(-1, length(nVec), length(pVec))
hdicmlDAG <- matrix(-1, length(nVec), length(pVec))
hdicmlDAGsd <- matrix(-1, length(nVec), length(pVec))
hdgdsDAG <- matrix(-1, length(nVec), length(pVec))
hdgdsDAGsd <- matrix(-1, length(nVec), length(pVec))
hdbfDAG <- matrix(-1, length(nVec), length(pVec))
hdbfDAGsd <- matrix(-1, length(nVec), length(pVec))
hdcpcDAG <- matrix(-1, length(nVec), length(pVec))
hdcpcDAGsd <- matrix(-1, length(nVec), length(pVec))
hdpcDAG <- matrix(-1, length(nVec), length(pVec))
hdpcDAGsd <- matrix(-1, length(nVec), length(pVec))
hdgesDAG <- matrix(-1, length(nVec), length(pVec))
hdgesDAGsd <- matrix(-1, length(nVec), length(pVec))
hdrandDAG <- matrix(-1, length(nVec), length(pVec))
hdrandDAGsd <- matrix(-1, length(nVec), length(pVec))

hdcamCPDAG <- matrix(-1, length(nVec), length(pVec))
hdcamCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdlingamCPDAG <- matrix(-1, length(nVec), length(pVec))
hdlingamCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdicmlCPDAG <- matrix(-1, length(nVec), length(pVec))
hdicmlCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdgdsCPDAG <- matrix(-1, length(nVec), length(pVec))
hdgdsCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdbfCPDAG <- matrix(-1, length(nVec), length(pVec))
hdbfCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdcpcCPDAG <- matrix(-1, length(nVec), length(pVec))
hdcpcCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdpcCPDAG <- matrix(-1, length(nVec), length(pVec))
hdpcCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdgesCPDAG <- matrix(-1, length(nVec), length(pVec))
hdgesCPDAGsd <- matrix(-1, length(nVec), length(pVec))
hdrandCPDAG <- matrix(-1, length(nVec), length(pVec))
hdrandCPDAGsd <- matrix(-1, length(nVec), length(pVec))

sidcamDAG <- matrix(-1, length(nVec), length(pVec))
sidcamDAGsd <- matrix(-1, length(nVec), length(pVec))
sidlingamDAG <- matrix(-1, length(nVec), length(pVec))
sidlingamDAGsd <- matrix(-1, length(nVec), length(pVec))
sidicmlDAG <- matrix(-1, length(nVec), length(pVec))
sidicmlDAGsd <- matrix(-1, length(nVec), length(pVec))
sidgdsDAG <- matrix(-1, length(nVec), length(pVec))
sidgdsDAGsd <- matrix(-1, length(nVec), length(pVec))
sidbfDAG <- matrix(-1, length(nVec), length(pVec))
sidbfDAGsd <- matrix(-1, length(nVec), length(pVec))
sidcpcDAGU <- matrix(-1, length(nVec), length(pVec))
sidcpcDAGUsd <- matrix(-1, length(nVec), length(pVec))
sidcpcDAGL <- matrix(-1, length(nVec), length(pVec))
sidcpcDAGLsd <- matrix(-1, length(nVec), length(pVec))
sidpcDAGU <- matrix(-1, length(nVec), length(pVec))
sidpcDAGUsd <- matrix(-1, length(nVec), length(pVec))
sidpcDAGL <- matrix(-1, length(nVec), length(pVec))
sidpcDAGLsd <- matrix(-1, length(nVec), length(pVec))
sidgesDAGU <- matrix(-1, length(nVec), length(pVec))
sidgesDAGUsd <- matrix(-1, length(nVec), length(pVec))
sidgesDAGL <- matrix(-1, length(nVec), length(pVec))
sidgesDAGLsd <- matrix(-1, length(nVec), length(pVec))
sidrandDAG <- matrix(-1, length(nVec), length(pVec))
sidrandDAGsd <- matrix(-1, length(nVec), length(pVec))


for(nCounter in 1:length(nVec))
{
  n <- nVec[nCounter]
  for(pCounter in 1:length(pVec))
  {
    p <- pVec[pCounter]
    if(nb_core > 1) {
      respar <- mcmapply(experiment2parralel,MoreArgs=list(p=p,n=n,linear=FALSE, pars = pars, hparams=hparams),1:nb_exp, dataset_path, funcType, mc.cores = nb_core)
    } else {
      respar <- mapply(experiment2parralel,MoreArgs=list(p=p,n=n,linear=FALSE, pars = pars, hparams=hparams),1:nb_exp, dataset_path, funcType)
    }
    
    save.image(paste(exp_path, "/", p, "N", n, ".RData", sep=""))
    
    # LINGAM
    sidlingamDAG[nCounter,pCounter] <- round(mean(respar[7,]),1)
    sidlingamDAGsd[nCounter,pCounter] <- round(sd(respar[7,]),1)
    hdlingamDAG[nCounter,pCounter] <- round(mean(respar[8,]),1)
    hdlingamDAGsd[nCounter,pCounter] <- round(sd(respar[8,]),1)
    hdlingamCPDAG[nCounter,pCounter] <- round(mean(respar[9,]),1)
    hdlingamCPDAGsd[nCounter,pCounter] <- round(sd(respar[9,]),1)
    lingam.time[nCounter,pCounter] <- round(mean(respar[33,]),3)
    lingam.time.sd[nCounter,pCounter] <- round(sd(respar[33,]),3)
    lingam.fdr[nCounter,pCounter] <- round(mean(respar[43,]),3)
    lingam.fdr.sd[nCounter,pCounter] <- round(sd(respar[43,]),3)
    
    # ICML
    sidicmlDAG[nCounter,pCounter] <- round(mean(respar[4,]),1)
    sidicmlDAGsd[nCounter,pCounter] <- round(sd(respar[4,]),1)
    hdicmlDAG[nCounter,pCounter] <- round(mean(respar[5,]),1)
    hdicmlDAGsd[nCounter,pCounter] <- round(sd(respar[5,]),1)
    hdicmlCPDAG[nCounter,pCounter] <- round(mean(respar[6,]),1)
    hdicmlCPDAGsd[nCounter,pCounter] <- round(sd(respar[6,]),1)
    icml.time[nCounter,pCounter] <- round(mean(respar[32,]),3)
    icml.time.sd[nCounter,pCounter] <- round(sd(respar[32,]),3)
    icml.fdr[nCounter,pCounter] <- round(mean(respar[42,]),3)
    icml.fdr.sd[nCounter,pCounter] <- round(sd(respar[42,]),3)
    
    # GDS
    sidgdsDAG[nCounter,pCounter] <- round(mean(respar[1,]),1)
    sidgdsDAGsd[nCounter,pCounter] <- round(sd(respar[1,]),1)
    hdgdsDAG[nCounter,pCounter] <- round(mean(respar[2,]),1)
    hdgdsDAGsd[nCounter,pCounter] <- round(sd(respar[2,]),1)
    hdgdsCPDAG[nCounter,pCounter] <- round(mean(respar[3,]),1)
    hdgdsCPDAGsd[nCounter,pCounter] <- round(sd(respar[3,]),1)
    gds.time[nCounter,pCounter] <- round(mean(respar[31,]),3)
    gds.time.sd[nCounter,pCounter] <- round(sd(respar[31,]),3)
    gds.fdr[nCounter,pCounter] <- round(mean(respar[41,]),3)
    gds.fdr.sd[nCounter,pCounter] <- round(sd(respar[41,]),3)
    
    # BF
    sidbfDAG[nCounter,pCounter] <- round(mean(respar[10,]),1)
    sidbfDAGsd[nCounter,pCounter] <- round(sd(respar[10,]),1)
    hdbfDAG[nCounter,pCounter] <- round(mean(respar[11,]),1)
    hdbfDAGsd[nCounter,pCounter] <- round(sd(respar[11,]),1)
    hdbfCPDAG[nCounter,pCounter] <- round(mean(respar[12,]),1)
    hdbfCPDAGsd[nCounter,pCounter] <- round(sd(respar[12,]),1)
    bf.time[nCounter,pCounter] <- round(mean(respar[34,]),3)
    bf.time.sd[nCounter,pCounter] <- round(sd(respar[34,]),3)
    bf.fdr[nCounter,pCounter] <- round(mean(respar[40,]),3)
    bf.fdr.sd[nCounter,pCounter] <- round(sd(respar[40,]),3)
    
    # CPC
    sidcpcDAGU[nCounter,pCounter] <- round(mean(respar[17,]),1)
    sidcpcDAGUsd[nCounter,pCounter] <- round(sd(respar[17,]),1)
    sidcpcDAGL[nCounter,pCounter] <- round(mean(respar[18,]),1)
    sidcpcDAGLsd[nCounter,pCounter] <- round(sd(respar[18,]),1)
    hdcpcDAG[nCounter,pCounter] <- round(mean(respar[19,]),1)
    hdcpcDAGsd[nCounter,pCounter] <- round(sd(respar[19,]),1)
    hdcpcCPDAG[nCounter,pCounter] <- round(mean(respar[20,]),1)
    hdcpcCPDAGsd[nCounter,pCounter] <- round(sd(respar[20,]),1)
    cpc.time[nCounter,pCounter] <- round(mean(respar[36,]),3)
    cpc.time.sd[nCounter,pCounter] <- round(sd(respar[36,]),3)
    cpc.fdr[nCounter,pCounter] <- round(mean(respar[45,]),3)
    cpc.fdr.sd[nCounter,pCounter] <- round(sd(respar[45,]),3)
    
    # PC
    sidpcDAGU[nCounter,pCounter] <- round(mean(respar[13,]),1)
    sidpcDAGUsd[nCounter,pCounter] <- round(sd(respar[13,]),1)
    sidpcDAGL[nCounter,pCounter] <- round(mean(respar[14,]),1)
    sidpcDAGLsd[nCounter,pCounter] <- round(sd(respar[14,]),1)
    hdpcDAG[nCounter,pCounter] <- round(mean(respar[15,]),1)
    hdpcDAGsd[nCounter,pCounter] <- round(sd(respar[15,]),1)
    hdpcCPDAG[nCounter,pCounter] <- round(mean(respar[16,]),1)
    hdpcCPDAGsd[nCounter,pCounter] <- round(sd(respar[16,]),1)
    pc.time[nCounter,pCounter] <- round(mean(respar[35,]),3)
    pc.time.sd[nCounter,pCounter] <- round(sd(respar[35,]),3)
    pc.fdr[nCounter,pCounter] <- round(mean(respar[44,]),3)
    pc.fdr.sd[nCounter,pCounter] <- round(sd(respar[44,]),3)
    
    # GES
    sidgesDAGU[nCounter,pCounter] <- round(mean(respar[21,]),1)
    sidgesDAGUsd[nCounter,pCounter] <- round(sd(respar[21,]),1)
    sidgesDAGL[nCounter,pCounter] <- round(mean(respar[22,]),1)
    sidgesDAGLsd[nCounter,pCounter] <- round(sd(respar[22,]),1)
    hdgesDAG[nCounter,pCounter] <- round(mean(respar[23,]),1)
    hdgesDAGsd[nCounter,pCounter] <- round(sd(respar[23,]),1)
    hdgesCPDAG[nCounter,pCounter] <- round(mean(respar[24,]),1)
    hdgesCPDAGsd[nCounter,pCounter] <- round(sd(respar[24,]),1)
    ges.time[nCounter,pCounter] <- round(mean(respar[37,]),3)
    ges.time.sd[nCounter,pCounter] <- round(sd(respar[37,]),3)
    ges.fdr[nCounter,pCounter] <- round(mean(respar[46,]),3)
    ges.fdr.sd[nCounter,pCounter] <- round(sd(respar[46,]),3)
    
    # RANDOM
    sidrandDAG[nCounter,pCounter] <- round(mean(respar[25,]),1)
    sidrandDAGsd[nCounter,pCounter] <- round(sd(respar[25,]),1)
    hdrandDAG[nCounter,pCounter] <- round(mean(respar[26,]),1)
    hdrandDAGsd[nCounter,pCounter] <- round(sd(respar[26,]),1)
    hdrandCPDAG[nCounter,pCounter] <- round(mean(respar[27,]),1)
    hdrandCPDAGsd[nCounter,pCounter] <- round(sd(respar[27,]),1)
    rand.time[nCounter,pCounter] <- round(mean(respar[38,]),3)
    rand.time.sd[nCounter,pCounter] <- round(sd(respar[38,]),3)
    rand.fdr[nCounter,pCounter] <- round(mean(respar[47,]),3)
    rand.fdr.sd[nCounter,pCounter] <- round(sd(respar[47,]),3)
    
    # CAM
    sidcamDAG[nCounter,pCounter] <- round(mean(respar[28,]),1)
    sidcamDAGsd[nCounter,pCounter] <- round(sd(respar[28,]),1)
    hdcamDAG[nCounter,pCounter] <- round(mean(respar[29,]),1)
    hdcamDAGsd[nCounter,pCounter] <- round(sd(respar[29,]),1)
    hdcamCPDAG[nCounter,pCounter] <- round(mean(respar[30,]),1)
    hdcamCPDAGsd[nCounter,pCounter] <- round(sd(respar[30,]),1)
    cam.time[nCounter,pCounter] <- round(mean(respar[39,]),3)
    cam.time.sd[nCounter,pCounter] <- round(sd(respar[39,]),3)
    cam.fdr[nCounter,pCounter] <- round(mean(respar[48,]),3)
    cam.fdr.sd[nCounter,pCounter] <- round(sd(respar[48,]),3)
  }
}

sink(paste(exp_path , "/results", funcType, ".txt", sep=""))

cat("======== \n")
cat("SID results \n")
cat("======== \n")
cat("CAM\n")
cat(sidcamDAG, " +- ", sidcamDAGsd, "\n \n")
cat("GDS\n")
cat(sidgdsDAG, " +- ", sidgdsDAGsd, "\n \n")
cat("BF\n")
cat(sidbfDAG, " +- ", sidbfDAGsd, "\n \n")
cat("ICML\n")
cat(sidicmlDAG, " +- ", sidicmlDAGsd, "\n \n")
cat("LINGAM\n")
cat(sidlingamDAG, " +- ", sidlingamDAGsd, "\n \n")
cat("cons PC\n")
cat("LB:", sidcpcDAGL, " +- ", sidcpcDAGLsd, "\n")
cat("UB:", sidcpcDAGU, " +- ", sidcpcDAGUsd, "\n \n")
cat("PC\n")
cat("LB:", sidpcDAGL, " +- ", sidpcDAGLsd, "\n")
cat("UB:", sidpcDAGU, " +- ", sidpcDAGUsd, "\n \n")
cat("GES\n")
cat("LB:", sidgesDAGL, " +- ", sidgesDAGLsd, "\n")
cat("UB:", sidgesDAGU, " +- ", sidgesDAGUsd, "\n \n")
cat("random\n")
cat(sidrandDAG, " +- ", sidrandDAGsd, "\n\n")


cat("======== \n")
cat("Hamming Dist results DAG \n")
cat("======== \n")
cat("CAM\n")
cat(hdcamDAG, " +- ", hdcamDAGsd, "\n \n")
cat("GDS\n")
cat(hdgdsDAG, " +- ", hdgdsDAGsd, "\n \n")
cat("BF\n")
cat(hdbfDAG, " +- ", hdbfDAGsd, "\n \n")
cat("ICML\n")
cat(hdicmlDAG, " +- ", hdicmlDAGsd, "\n \n")
cat("LINGAM\n")
cat(hdlingamDAG, " +- ", hdlingamDAGsd, "\n \n")
cat("CPC\n")
cat(hdcpcDAG, " +- ", hdcpcDAGsd, "\n \n")
cat("PC\n")
cat(hdpcDAG, " +- ", hdpcDAGsd, "\n \n")
cat("GES\n")
cat(hdgesDAG, " +- ", hdgesDAGsd, "\n \n")
cat("random\n")
cat(hdrandDAG, " +- ", hdrandDAGsd, "\n\n")


cat("======== \n")
cat("Hamming Dist results CPDAG \n")
cat("======== \n")
cat("CAM\n")
cat(hdcamCPDAG, " +- ", hdcamCPDAGsd, "\n \n")
cat("GDS\n")
cat(hdgdsCPDAG, " +- ", hdgdsCPDAGsd, "\n \n")
cat("BF\n")
cat(hdbfCPDAG, " +- ", hdbfCPDAGsd, "\n \n")
cat("ICML\n")
cat(hdicmlCPDAG, " +- ", hdicmlCPDAGsd, "\n \n")
cat("LINGAM\n")
cat(hdlingamCPDAG, " +- ", hdlingamCPDAGsd, "\n \n")
cat("CPC\n")
cat(hdcpcCPDAG, " +- ", hdcpcCPDAGsd, "\n \n")
cat("PC\n")
cat(hdpcCPDAG, " +- ", hdpcCPDAGsd, "\n \n")
cat("GES\n")
cat(hdgesCPDAG, " +- ", hdgesCPDAGsd, "\n \n")
cat("random\n")
cat(hdrandCPDAG, " +- ", hdrandCPDAGsd, "\n\n")

cat("======== \n")
cat("FDR results \n")
cat("======== \n")
cat("CAM\n")
cat(cam.fdr, " +- ", cam.fdr.sd, "\n \n")
cat("GDS\n")
cat(gds.fdr, " +- ", gds.fdr.sd, "\n \n")
cat("BF\n")
cat(bf.fdr, " +- ", bf.fdr.sd, "\n \n")
cat("ICML\n")
cat(icml.fdr, " +- ", icml.fdr.sd, "\n \n")
cat("LINGAM\n")
cat(lingam.fdr, " +- ", lingam.fdr.sd, "\n \n")
cat("CPC\n")
cat(cpc.fdr, " +- ", cpc.fdr.sd, "\n \n")
cat("PC\n")
cat(pc.fdr.sd, " +- ", pc.fdr.sd, "\n \n")
cat("GES\n")
cat(ges.fdr, " +- ", ges.fdr.sd, "\n \n")
cat("random\n")
cat(rand.fdr, " +- ", rand.fdr.sd, "\n\n")

cat("======== \n")
cat("Time per method \n")
cat("======== \n")
cat("CAM\n")
cat(cam.time, " +- ", cam.time.sd, "\n \n")
cat("GDS\n")
cat(gds.time, " +- ", gds.time.sd, "\n \n")
cat("BF\n")
cat(bf.time, " +- ", bf.time.sd, "\n \n")
cat("ICML\n")
cat(icml.time, " +- ", icml.time.sd, "\n \n")
cat("LINGAM\n")
cat(lingam.time, " +- ", lingam.time.sd, "\n \n")
cat("CPC\n")
cat(cpc.time, " +- ", cpc.time.sd, "\n \n")
cat("PC\n")
cat(pc.time.sd, " +- ", pc.time.sd, "\n \n")
cat("GES\n")
cat(ges.time, " +- ", ges.time.sd, "\n \n")
cat("random\n")
cat(rand.time, " +- ", rand.time.sd, "\n\n")

sink()

cat("\n")
